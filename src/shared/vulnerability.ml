open Graphjs_base

type t =
  | CodeInjection
  | CommandInjection
  | PathTraversal

let hash : t -> int = function
  | CodeInjection -> 1
  | CommandInjection -> 2
  | PathTraversal -> 3

let equal (vuln1 : t) (vuln2 : t) : bool =
  match (vuln1, vuln2) with
  | (CodeInjection, CodeInjection) -> true
  | (CommandInjection, CommandInjection) -> true
  | (PathTraversal, PathTraversal) -> true
  | _ -> false

let compare (vuln1 : t) (vuln2 : t) : int =
  Int.compare (hash vuln1) (hash vuln2)
[@@inline]

let pp (ppf : Fmt.t) : t -> unit = function
  | CodeInjection -> Fmt.pp_str ppf "code-injection"
  | CommandInjection -> Fmt.pp_str ppf "command-injection"
  | PathTraversal -> Fmt.pp_str ppf "path_traversal"

let str (vuln : t) : string = Fmt.str "%a" pp vuln [@@inline]
